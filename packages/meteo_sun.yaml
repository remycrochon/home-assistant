input_boolean:
  # Validation notification alerte météo 
  stop_notif_previ_pluie:
    name: Stop Notif Previ Pluie

# https://forum.hacf.fr/t/alerte-meteo/23930/61
command_line:
  - sensor:
      name: meteo_france_alertes_81
      scan_interval: 10800
      command: >         
        curl -X GET "https://public-api.meteofrance.fr/public/DPVigilance/v1/cartevigilance/encours" -H "accept: */*" -H "apikey:eyJ4NXQiOiJZV0kxTTJZNE1qWTNOemsyTkRZeU5XTTRPV014TXpjek1UVmhNbU14T1RSa09ETXlOVEE0Tnc9PSIsImtpZCI6ImdhdGV3YXlfY2VydGlmaWNhdGVfYWxpYXMiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJyZW15LmNyb2Nob25AY2FyYm9uLnN1cGVyIiwiYXBwbGljYXRpb24iOnsib3duZXIiOiJyZW15LmNyb2Nob24iLCJ0aWVyUXVvdGFUeXBlIjpudWxsLCJ0aWVyIjoiVW5saW1pdGVkIiwibmFtZSI6IkRlZmF1bHRBcHBsaWNhdGlvbiIsImlkIjoyMTcwLCJ1dWlkIjoiM2JlNDlhZTktZTljZi00N2NmLWFkNzAtMzQyZGM1MWVhY2VjIn0sImlzcyI6Imh0dHBzOlwvXC9wb3J0YWlsLWFwaS5tZXRlb2ZyYW5jZS5mcjo0NDNcL29hdXRoMlwvdG9rZW4iLCJ0aWVySW5mbyI6eyI2MFJlcVBhck1pbiI6eyJ0aWVyUXVvdGFUeXBlIjoicmVxdWVzdENvdW50IiwiZ3JhcGhRTE1heENvbXBsZXhpdHkiOjAsImdyYXBoUUxNYXhEZXB0aCI6MCwic3RvcE9uUXVvdGFSZWFjaCI6dHJ1ZSwic3Bpa2VBcnJlc3RMaW1pdCI6MCwic3Bpa2VBcnJlc3RVbml0Ijoic2VjIn19LCJrZXl0eXBlIjoiUFJPRFVDVElPTiIsInBlcm1pdHRlZFJlZmVyZXIiOiIiLCJzdWJzY3JpYmVkQVBJcyI6W3sic3Vic2NyaWJlclRlbmFudERvbWFpbiI6ImNhcmJvbi5zdXBlciIsIm5hbWUiOiJEb25uZWVzUHVibGlxdWVzVmlnaWxhbmNlIiwiY29udGV4dCI6IlwvcHVibGljXC9EUFZpZ2lsYW5jZVwvdjEiLCJwdWJsaXNoZXIiOiJhZG1pbiIsInZlcnNpb24iOiJ2MSIsInN1YnNjcmlwdGlvblRpZXIiOiI2MFJlcVBhck1pbiJ9XSwidG9rZW5fdHlwZSI6ImFwaUtleSIsInBlcm1pdHRlZElQIjoiIiwiaWF0IjoxNjk4ODYxNDExLCJqdGkiOiIwMzk3NWQ2Yy1kMjFlLTQzNGEtYWYyYi1jYzRlYTZmNWIwNzIifQ==.Oq7NX1VNSQAspuVPbwucOc2eyzirkPKdZJv6kozV5WcvH071niq9_OkVfmhea0V_b9QVUZLxaG8WfeDRQIV1mqvwg36-PChrzjRdXlMdZqwWvDrEWl02Q6h9PcgFYqcQj_LoP8zSGX7JQsdZBnXbU4PEsQFUnlvEwKm1wpozs4jSLRv-swJtcyElWqKudnYatSh06qrwEXJsFjOslgpcgp1rJjpRge_-sDHQ2XvcUoICB0PIBg0v0XYuk0FJMoTBEgREPUmHTijJt0WXT3z-vRfhbhnAVI9ekUIilcyGtHizl-0o0wytmIsDJY_l0KXuwo2EcT_ZcQVNGbT8JXU1UQ==" | jq '{details: {"domain_max_color_id_today": .product.periods[0].timelaps.domain_ids[79].max_color_id,"domain_max_color_id_tomorrow": .product.periods[1].timelaps.domain_ids[79].max_color_id, "update_time": .product.update_time}, "today": .product.periods[0].timelaps.domain_ids[79].phenomenon_items | sort_by(.phenomenon_id), "tomorrow": .product.periods[1].timelaps.domain_ids[79].phenomenon_items | sort_by(.phenomenon_id)}'
      value_template: "{{ value_json.details.domain_max_color_id_today }}"
      unique_id: meteo_france_alertes_81
      json_attributes:
          - details
          - today
          - tomorrow

  - sensor:
      name: meteo_france_alertes_picture_today
      scan_interval: 14400
      command: >  
          curl -X GET "https://public-api.meteofrance.fr/public/DPVigilance/v1/vignettenationale-J/encours" -H "accept: */*" -H "apikey:eyJ4NXQiOiJZV0kxTTJZNE1qWTNOemsyTkRZeU5XTTRPV014TXpjek1UVmhNbU14T1RSa09ETXlOVEE0Tnc9PSIsImtpZCI6ImdhdGV3YXlfY2VydGlmaWNhdGVfYWxpYXMiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJyZW15LmNyb2Nob25AY2FyYm9uLnN1cGVyIiwiYXBwbGljYXRpb24iOnsib3duZXIiOiJyZW15LmNyb2Nob24iLCJ0aWVyUXVvdGFUeXBlIjpudWxsLCJ0aWVyIjoiVW5saW1pdGVkIiwibmFtZSI6IkRlZmF1bHRBcHBsaWNhdGlvbiIsImlkIjoyMTcwLCJ1dWlkIjoiM2JlNDlhZTktZTljZi00N2NmLWFkNzAtMzQyZGM1MWVhY2VjIn0sImlzcyI6Imh0dHBzOlwvXC9wb3J0YWlsLWFwaS5tZXRlb2ZyYW5jZS5mcjo0NDNcL29hdXRoMlwvdG9rZW4iLCJ0aWVySW5mbyI6eyI2MFJlcVBhck1pbiI6eyJ0aWVyUXVvdGFUeXBlIjoicmVxdWVzdENvdW50IiwiZ3JhcGhRTE1heENvbXBsZXhpdHkiOjAsImdyYXBoUUxNYXhEZXB0aCI6MCwic3RvcE9uUXVvdGFSZWFjaCI6dHJ1ZSwic3Bpa2VBcnJlc3RMaW1pdCI6MCwic3Bpa2VBcnJlc3RVbml0Ijoic2VjIn19LCJrZXl0eXBlIjoiUFJPRFVDVElPTiIsInBlcm1pdHRlZFJlZmVyZXIiOiIiLCJzdWJzY3JpYmVkQVBJcyI6W3sic3Vic2NyaWJlclRlbmFudERvbWFpbiI6ImNhcmJvbi5zdXBlciIsIm5hbWUiOiJEb25uZWVzUHVibGlxdWVzVmlnaWxhbmNlIiwiY29udGV4dCI6IlwvcHVibGljXC9EUFZpZ2lsYW5jZVwvdjEiLCJwdWJsaXNoZXIiOiJhZG1pbiIsInZlcnNpb24iOiJ2MSIsInN1YnNjcmlwdGlvblRpZXIiOiI2MFJlcVBhck1pbiJ9XSwidG9rZW5fdHlwZSI6ImFwaUtleSIsInBlcm1pdHRlZElQIjoiIiwiaWF0IjoxNjk4ODYxNDExLCJqdGkiOiIwMzk3NWQ2Yy1kMjFlLTQzNGEtYWYyYi1jYzRlYTZmNWIwNzIifQ==.Oq7NX1VNSQAspuVPbwucOc2eyzirkPKdZJv6kozV5WcvH071niq9_OkVfmhea0V_b9QVUZLxaG8WfeDRQIV1mqvwg36-PChrzjRdXlMdZqwWvDrEWl02Q6h9PcgFYqcQj_LoP8zSGX7JQsdZBnXbU4PEsQFUnlvEwKm1wpozs4jSLRv-swJtcyElWqKudnYatSh06qrwEXJsFjOslgpcgp1rJjpRge_-sDHQ2XvcUoICB0PIBg0v0XYuk0FJMoTBEgREPUmHTijJt0WXT3z-vRfhbhnAVI9ekUIilcyGtHizl-0o0wytmIsDJY_l0KXuwo2EcT_ZcQVNGbT8JXU1UQ==" > ./www/images/meteo_france_alerte_today.png
      value_template: "mf_alert_today"
      unique_id: meteo_france_alerts_picture_today
      
  - sensor:
      name: meteo_france_alertes_picture_tomorrow
      scan_interval: 14400
      command: >  
          curl -X GET "https://public-api.meteofrance.fr/public/DPVigilance/v1/vignettenationale-J1/encours" -H "accept: */*" -H "apikey:eyJ4NXQiOiJZV0kxTTJZNE1qWTNOemsyTkRZeU5XTTRPV014TXpjek1UVmhNbU14T1RSa09ETXlOVEE0Tnc9PSIsImtpZCI6ImdhdGV3YXlfY2VydGlmaWNhdGVfYWxpYXMiLCJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJzdWIiOiJyZW15LmNyb2Nob25AY2FyYm9uLnN1cGVyIiwiYXBwbGljYXRpb24iOnsib3duZXIiOiJyZW15LmNyb2Nob24iLCJ0aWVyUXVvdGFUeXBlIjpudWxsLCJ0aWVyIjoiVW5saW1pdGVkIiwibmFtZSI6IkRlZmF1bHRBcHBsaWNhdGlvbiIsImlkIjoyMTcwLCJ1dWlkIjoiM2JlNDlhZTktZTljZi00N2NmLWFkNzAtMzQyZGM1MWVhY2VjIn0sImlzcyI6Imh0dHBzOlwvXC9wb3J0YWlsLWFwaS5tZXRlb2ZyYW5jZS5mcjo0NDNcL29hdXRoMlwvdG9rZW4iLCJ0aWVySW5mbyI6eyI2MFJlcVBhck1pbiI6eyJ0aWVyUXVvdGFUeXBlIjoicmVxdWVzdENvdW50IiwiZ3JhcGhRTE1heENvbXBsZXhpdHkiOjAsImdyYXBoUUxNYXhEZXB0aCI6MCwic3RvcE9uUXVvdGFSZWFjaCI6dHJ1ZSwic3Bpa2VBcnJlc3RMaW1pdCI6MCwic3Bpa2VBcnJlc3RVbml0Ijoic2VjIn19LCJrZXl0eXBlIjoiUFJPRFVDVElPTiIsInBlcm1pdHRlZFJlZmVyZXIiOiIiLCJzdWJzY3JpYmVkQVBJcyI6W3sic3Vic2NyaWJlclRlbmFudERvbWFpbiI6ImNhcmJvbi5zdXBlciIsIm5hbWUiOiJEb25uZWVzUHVibGlxdWVzVmlnaWxhbmNlIiwiY29udGV4dCI6IlwvcHVibGljXC9EUFZpZ2lsYW5jZVwvdjEiLCJwdWJsaXNoZXIiOiJhZG1pbiIsInZlcnNpb24iOiJ2MSIsInN1YnNjcmlwdGlvblRpZXIiOiI2MFJlcVBhck1pbiJ9XSwidG9rZW5fdHlwZSI6ImFwaUtleSIsInBlcm1pdHRlZElQIjoiIiwiaWF0IjoxNjk4ODYxNDExLCJqdGkiOiIwMzk3NWQ2Yy1kMjFlLTQzNGEtYWYyYi1jYzRlYTZmNWIwNzIifQ==.Oq7NX1VNSQAspuVPbwucOc2eyzirkPKdZJv6kozV5WcvH071niq9_OkVfmhea0V_b9QVUZLxaG8WfeDRQIV1mqvwg36-PChrzjRdXlMdZqwWvDrEWl02Q6h9PcgFYqcQj_LoP8zSGX7JQsdZBnXbU4PEsQFUnlvEwKm1wpozs4jSLRv-swJtcyElWqKudnYatSh06qrwEXJsFjOslgpcgp1rJjpRge_-sDHQ2XvcUoICB0PIBg0v0XYuk0FJMoTBEgREPUmHTijJt0WXT3z-vRfhbhnAVI9ekUIilcyGtHizl-0o0wytmIsDJY_l0KXuwo2EcT_ZcQVNGbT8JXU1UQ==" > ./www/images/meteo_france_alerte_tomorrow.png
      value_template: "mf_alert_tomorrow"
      unique_id: meteo_france_alerts_picture_tomorrow

camera:
  - platform: local_file
    name: MF_alerte_today
    file_path: ./www/images/meteo_france_alerte_today.png
    
  - platform: local_file
    name: MF_alerte_tomorrow
    file_path: ./www/images/meteo_france_alerte_tomorrow.png

mqtt:
  sensor:
# Vantage Pro2 -> WEEXWX
    - name: "VP2_DateTime"
      unique_id: VP2_DateTime" 
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'ms'
      value_template: "{{ value_json.dateTime | round(1) }}"

    - name: "VP2_Temp_Out"
      unique_id: "VP2_Temp_Out"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: '°C'
      value_template: "{{ value_json.outTemp_C | round(1) }}"
      state_class: measurement
      device_class: "temperature"

    - name: "VP2_Humidity_Out"
      unique_id: "VP2_Humidity_Out"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: '%'
      value_template: "{{ value_json.outHumidity | round(1) }}"
      state_class: measurement      
      device_class: humidity
          
    - name: "VP2_Barometer"
      unique_id: "VP2_Barometer"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'mbar'
      value_template: "{{ value_json.barometer_mbar | round(1) }}"
      state_class: measurement
      device_class: "pressure"
      
  #DAILY RAIN (PRECIPITATION QUOTIDIENNE).
  #Appuyez sur RAINDAY pour afficher la pluviométrie cumulée depuis minuit.
  #Toutes les précipitations cumulées depuis les 24 dernières heures sont affichées dans le bandeau déroulant au bas de l'écran.
    - name: "VP2_Rain"
      unique_id: "VP2_Rain"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'mm'
      force_update: true
      value_template: >-
        {% set a=value_json.rain_cm|float(default=0)%}
        {{ (a*10)|round(3) }}     
      state_class: measurement
      device_class: precipitation

    - name: "VP2_Rain24"
      unique_id: "VP2_Rain24"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'mm'
      force_update: true
      value_template: >-
        {% set a=value_json.rain24_cm|float(default=0)%}
        {{ (a*10)|round(3) }}
      state_class: total_increasing
      device_class: precipitation

    - name: "VP2_RainJour"
      unique_id: "VP2_RainJour"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'mm'
      force_update: true
      value_template: >-
        {% set a=value_json.dayRain_cm|float(default=0)%}
        {{ (a*10)|round(3) }}
      state_class: total_increasing
      device_class: precipitation

  # La Rain Rate (pluviométrie) sera nulle et l'icône parapluie ne sera pas affichée tant que
  # deux basculements du pluviomètre ne sont pas survenus dans une période de 15 minutes.
    - name: "VP2_Rain_Rate"
      unique_id: "VP2_Rain_Rate"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'mm/h'
      force_update: true
      value_template: >-
        {% set a=value_json.rainRate_cm_per_hour|float(default=0)%}
        {{ (a*10)|round(3) }}
      state_class: measurement
      device_class: PRECIPITATION_INTENSITY

  #RAIN STORM (AVERSE D'ORAGE).
  #Rain Storm (L'averse d'orage) affiche le cumul de pluie de la dernière averse.
  #Il faut deux basculements du pluviomètre pour démarrer un événement d'orage et 24 heures sans pluie pour le stopper.
  #Appuyez sur RAINDAY pour basculer entre les précipitations quotidiennes et le total d'Averse d'orage.
  #Le cumul de pluie peut être affiché en pouces (in) ou millimètres (mm).    
    - name: "VP2_Rain_Storm"
      unique_id: "VP2_Rain_Storm"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'mm'
      force_update: true
      value_template: >-
        {% set a=value_json.stormRain_cm|float(default=0)%}
        {{ (a*10)|round(3) }}
      state_class: measurement
      device_class: precipitation            

    - name: "VP2_Rafale"
      unique_id: "VP2_Rafale"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'km/h'
      value_template: "{{ value_json.windGust_kph | round(2) }}"
      state_class: measurement
      device_class: WIND_SPEED

    - name: "VP2_Win_Speed"
      unique_id: "VP2_Win_Speed"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'km/h'
      value_template: "{{ value_json.windSpeed_kph | round(2) }}"
      state_class: measurement
      device_class: WIND_SPEED
      
    - name: "VP2_Win_Dir"
      unique_id: "VP2_Win_Dir"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: '°'
      value_template: "{{ value_json.windDir | round(1) }}"
      state_class: measurement
            

    - name: "VP2_Temp_In"
      unique_id: "VP2_Temp_In"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: '°C'
      value_template: "{{ value_json.inTemp_C | round(1) }}"
      device_class: "temperature"
      state_class: measurement

    - name: "VP2_Humidté_In"
      unique_id: "VP2_Humidté_In"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: '%'
      value_template: "{{ value_json.inHumidity | round(1) }}"
      device_class: "humidity"
      state_class: measurement

    - name: "VP2_Ressenti"
      unique_id: "VP2_Ressenti"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: '°C'
      value_template: "{{ value_json.windchill_C | round(1) }}"
      device_class: "temperature"
      state_class: measurement

    - name: "VP2_HeatIndex"
      unique_id: "VP2_HeatIndex"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: '°C'
      value_template: "{{ value_json.heatindex_C | round(1) }}"
      device_class: "temperature"
      state_class: measurement

    - name: "VP2_Radiation"
      unique_id: "VP2_Radiation"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'W/m²'
      value_template: "{{ value_json.radiation_Wpm2 | round(0) }}"
      device_class: irradiance
      state_class: measurement

    - name: "VP2_UV"
      unique_id: "VP2_UV"
      state_topic: "home/Vp2/loop"
      unit_of_measurement: 'UV'
      value_template: "{{ value_json.UV | round(1) }}"
      state_class: measurement

sensor:
# lune https://www.home-assistant.io/integrations/moon/
#  - platform: moon

#  - platform: season  
template:
  - sensor:
    - unit_of_measurement: °
      default_entity_id: sensor.sun_elevation
      name: elevation soleil
      state: '{{''%+.1f''|format(state_attr(''sun.sun'', ''elevation''))}}'

    - unit_of_measurement: °
      default_entity_id: sensor.sun_azimuth
      name: azimut soleil
      state: '{{''%+.1f''|format(state_attr(''sun.sun'', ''azimuth''))}}'


# calcul de l'heure lever et coucher du soleil
    - default_entity_id: sensor.heure_leve_soleil
      icon: mdi:weather-sunset-up
      name: heure_leve_soleil
      state: '{{ as_timestamp(states.sun.sun.attributes.next_rising) | timestamp_custom(''%H
        %M'')}}'

    - default_entity_id: sensor.heure_couche_soleil
      icon: mdi:weather-sunset-down
      name: heure_couche_soleil
      state: '{{ as_timestamp(states.sun.sun.attributes.next_setting) | timestamp_custom(''
        %H %M'')}}'

# Prevision Pluie
#      h_arrivee_pluie:
#        friendly_name: 'Heure arrivée de la Pluie'
#        value_template: >
#          {{ as_timestamp(states('sensor.albi_next_rain')) | timestamp_custom('%H:%M') }}

# Direction du vent
    - unique_id: vp2_direction_du_vent
      default_entity_id: sensor.vp2_direction_du_vent
      name: Vp2 Direction Du vent
      state: "{% set dv=state_attr('weather.albi','wind_bearing')|float(default=0)%}
        {% if dv<11 %}\n  {{'N'}}\n{% elif dv<34 %}\n  {{'NNE'}}\n{% elif dv<57 %}\n
        \ {{'NE'}}\n{% elif dv<79 %}\n  {{'ENE'}}\n{% elif dv<101 %}\n  {{'E'}}\n{%
        elif dv<124 %}\n  {{'ESE'}}\n{% elif dv<146 %}\n  {{'SE'}}\n{% elif dv<169 %}\n
        \ {{'SSE'}}\n{% elif dv<191 %}\n  {{'S'}}\n{% elif dv<214 %}\n  {{'SSO'}}\n{%
        elif dv<236 %}\n  {{'SO'}}\n{% elif dv<259 %}\n  {{'OSO'}}\n{% elif dv<281 %}\n
        \ {{'O'}}\n{% elif dv<304 %}\n  {{'ONO'}}\n{% elif dv<326 %}\n  {{'NO'}}\n{%
        elif dv<349 %}\n  {{'NNO'}}\n{% else %}\n  {{'N'}}\n{%endif%}"


# Integration Amber -> Pollen

    - unique_id: grass_pollen_index_mod
      default_entity_id: sensor.grass_pollen_index_mod
      icon: mdi:flower
      name: Pollen Grass Amber
      state: "{% if is_state('sensor.pollen_grass_risk', 'low') %}\n  0\n{% elif is_state('sensor.pollen_grass_risk','moderate')
        %}\n  1\n{% elif is_state('sensor.pollen_grass_risk','high') %}\n  2\n{% elif
        is_state('sensor.pollen_grass_risk','very_high') %}\n  3\n{% else %}\n  Unknown\n{%
        endif %}"

    - unique_id: tree_pollen_index_mod
      default_entity_id: sensor.tree_pollen_index_mod
      icon: mdi:tree
      name: Pollen Tree Amber
      state: "{% if is_state('sensor.pollen_tree_risk', 'low') %}\n  0\n{% elif is_state('sensor.pollen_tree_risk','moderate')
        %}\n  1\n{% elif is_state('sensor.pollen_tree_risk','high') %}\n  2\n{% elif
        is_state('sensor.pollen_tree_risk','very_high') %}\n  3\n{% else %}\n  Unknown\n{%
        endif %}"

    - unique_id: weed_pollen_index_mod
      default_entity_id: sensor.weed_pollen_index_mod
      icon: mdi:sprout
      name: Pollen Weed Amber
      state: "{% if is_state('sensor.pollen_weed_risk', 'low') %}\n  0\n{% elif is_state('sensor.pollen_weed_risk','moderate')
        %}\n  1\n{% elif is_state('sensor.pollen_weed_risk','high') %}\n  2\n{% elif
        is_state('sensor.pollen_weed_risk','very_high') %}\n  3\n{% else %}\n  Unknown\n{%
        endif %}"


# Integration Météo France
    - unique_id: mf_temperature
      unit_of_measurement: °C
      default_entity_id: sensor.mf_temperature
      state: '{{ state_attr(''weather.albi'',''temperature'') }}'
      name: mf_temperature

    - unique_id: mf_humidity
      default_entity_id: sensor.mf_humidity
      state: '{{ state_attr(''weather.albi'',''humidity'') }}'
      name: mf_humidity

    - unique_id: mf_pressure
      unit_of_measurement: hPa
      default_entity_id: sensor.mf_pressure
      state: '{{ state_attr(''weather.albi'',''pressure'') }}'
      name: mf_pressure

#      mf_current_conditions:
#        value_template: >-
#          {{ states.weather.albi.state }}

    - unique_id: mf_current_conditions
      default_entity_id: sensor.mf_current_conditions
      state: "{% set weather_state = states('weather.albi') \n  | replace('rainy', 'Pluvieux')\n
        \ | replace('partlycloudy', 'Partiellement nuageux')\n  | replace('cloudy',
        'Nuageux')\n  | replace('clear-night', 'Nuit claire')\n  | replace('fog', 'Brouillard')\n
        \ | replace('hail', 'Grêle')\n  | replace('lightning-rainy', 'Pluie orageuse')\n
        \ | replace('lightning', 'Orages') \n  | replace('pouring', 'Fortes pluies')\n
        \ | replace('snowy-rainy', 'Neigeux')\n  | replace('snowy', 'Neigeux')\n  |
        replace('sunny', 'Ensoleillé')\n  | replace('windy-variant', 'Venteux')\n  |
        replace('windy', 'Venteux')\n  | replace('exceptional', 'Exceptionel') %}"
      name: mf_current_conditions

  #        feels_like
    - unique_id: mf_visibility
      default_entity_id: sensor.mf_visibility
      state: '{{state_attr(''weather.albi'',''visibility'') }}'
      name: mf_visibility

    - unique_id: mf_wind_bearing
      default_entity_id: sensor.mf_wind_bearing
      state: '{{state_attr(''weather.albi'',''wind_bearing'') }}'
      name: mf_wind_bearing

    - unique_id: mf_wind_speed
      default_entity_id: sensor.mf_wind_speed
      state: '{{ state_attr(''weather.albi'',''wind_speed'') }}'
      name: mf_wind_speed

    - unique_id: mf_o3
      default_entity_id: sensor.mf_o3
      state: '{{ state_attr(''weather.albi'',''ozone'') }}'
      name: mf_o3


# Meteo france
    # Utilisés dans boutton-card de la page /remy-2/home 
    - unique_id: meteo_france_orage
      default_entity_id: sensor.meteo_france_orage
      name: Orages
      state: '{{ state_attr(''sensor.81_weather_alert'', ''Orages'') }}'

    - unique_id: meteo_france_inondation
      default_entity_id: sensor.meteo_france_inondation
      name: Inondation
      state: '{{ state_attr(''sensor.81_weather_alert'', ''Inondation'') }}'

    - unique_id: meteo_france_pluie_inondation
      default_entity_id: sensor.meteo_france_pluie_inondation
      name: Pluie-Inondation
      state: '{{ state_attr(''sensor.81_weather_alert'', ''Pluie-inondation'') }}'      

    - unique_id: meteo_france_grand_froid
      default_entity_id: sensor.meteo_france_grand_froid
      name: Grand-froid
      state: '{{ state_attr(''sensor.81_weather_alert'', ''Grand-froid'') }}'      

    - unique_id: meteo_france_vent
      default_entity_id: sensor.meteo_france_vent
      name: Vent violent
      state: '{{ state_attr(''sensor.81_weather_alert'', ''Vent violent'') }}'        

    - unique_id: meteo_france_neige
      default_entity_id: sensor.meteo_france_neige
      name: Neige-verglas
      state: '{{ state_attr(''sensor.81_weather_alert'', ''Neige-verglas'') }}'     


    - unique_id: weather_icon
      default_entity_id: sensor.weather_icon
      state: "{% set weather_icon = states('weather.albi') \n  | replace('rainy', '☔️')\n
        \ | replace('partlycloudy', '⛅️')\n  | replace('cloudy', '☁️')\n  | replace('clear-night',
        '✨')\n  | replace('fog', '\U0001F300')\n  | replace('hail', '\U0001F327')\n
        \ | replace('lightning-rainy', '⛈')\n  | replace('lightning', '⚡️') \n  | replace('pourring',
        '️☔️')\n  | replace('snowy-rainy', '❄️️')\n  | replace('snowy', '❄️')\n  | replace('sunny',
        '☀️')\n  | replace('windy-variant', '\U0001F4A8')\n  | replace('windy', '\U0001F4A8')\n
        \ | replace('exceptional', '⚠️') %}     \n\n{% if not state_attr('weather.maison',
        'temperature') == 'Indisponible' -%}\n  {% if states('weather.albi') == 'lightning-rainy'
        -%}\n    ⛈\n  {% else -%}\n  {{ weather_icon }}\n  {% endif -%}\n{% else -%}
        {% endif -%}"
      name: weather_icon


