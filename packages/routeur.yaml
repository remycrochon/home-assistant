rest_command:
  cde_dimmer:
    url: http://192.168.0.67/?POWER={{ states('sensor.consigne_puissance_dimmer')}}

template:
  - sensor:
#    - name: Consigne Puissance Dimmer
#      unique_id: "consigne_puissance_dimmer"
#      unit_of_measurement: "%"
#      state: >-
#        {% set p = states('sensor.mp2_grid_l1') | float(default=0) %}
#        {% if (p<0) %}
#          {{ p*-1/20}}
#        {%else%}
#          0
#        {%endif%}  

        
    - name: Consigne Puissance Dimmer
      unique_id: "consigne_puissance_dimmer"
      unit_of_measurement: "%"
      state: >-
        {% set p = states('input_number.valeur_dimer') | float(default=0) %}
        {% if (p<0) %}
          {{ 0 }}
        {%else%}
          {% if (p>100) %}
            {{ 100 }}
          {%endif%}
          {{ p }}
        {%endif%}