mqtt:
  sensor:
  # MQTT
    - name: "MP2 SoC Affiché"
      unique_id: mp2_soc_affiche
      state_topic: "mp2/batteries/soc_affiche"
      unit_of_measurement: "%"
      device_class: battery
      state_class: measurement

    - name: "MP2 SoC théorique Lineaire"
      unique_id: mp2_soc_lin_json
      state_topic: "mp2/batteries/soc_theorique"
      unit_of_measurement: "%"
      device_class: battery
      state_class: measurement
      value_template: "{{ value_json.get('SoClin', 0) | float(0) }}"

    - name: "MP2 VALIDE CP MQTT"
      unique_id: mp2_valide_cp_par_mqtt
      state_topic: "mp2/multiplus2/valide_cp"

    - name: "Capacité Batterie Estimée par NR"
      state_topic: "mp2/batteries/capacity_est_ah"
      unit_of_measurement: "Ah"
      icon: mdi:battery-charging-outline
      state_class: measurement

      # DESS Remy

    - name: "MP2 DESS Cible SOC par MQTT"
      unique_id: mp2_dess_cible_soc
      state_topic: "mp2/dess_remy/cible_soc"
      unit_of_measurement: '%'
      device_class: battery
      state_class: measurement

    - name: "MP2 DESS Difference Cible-SOC"
      unique_id: mp2_difference_cible_soc
      state_topic: "mp2/dess_remy/diff_soc"
      unit_of_measurement: '%'
      device_class: battery
      state_class: measurement

    - name: "MP2 DESS H_Debut DESS Remy"
      unique_id: mp2_dess_h_debut
      state_topic: "mp2/dess_remy/h_debut"   

    - name: "MP2 DESS Durée DESS Remy"
      unique_id: mp2_dess_duree
      state_topic: "mp2/dess_remy/duree"      

    - name: "MP2 DESS Remy Log Audit"
      unique_id: mp2_dess_log_audit
      state_topic: "mp2/dess_remy/log_audit"      

    - name: "MP2 DESS Previ Conso 6-22 J1"
      unique_id: mp2_dess_previ_conso_6_22_j1
      state_topic: "mp2/dess_remy/previ_conso_6-22-J1"
      unit_of_measurement: "kWh"
      device_class: "energy"
      state_class: "measurement"
      
    - name: "MP2 DESS Previ Prod 6-22 J1"
      unique_id: mp2_dess_previ_prod_6_22_j1
      state_topic: "mp2/dess_remy/previ_prod_6-22-J1"
      unit_of_measurement: "kWh"
      device_class: "energy"
      state_class: "measurement"

# Victron
#modbus:
#  - name: cerbo
#    host: 192.168.0.86
#    type: tcp
#    port: 502
#    switches:
#      - name: "MP2 cde"
#        slave: 227
#        address: 33
#        command_on: 3
#        command_off: 4
#        verify:
#          input_type: holding
#          address: 33
#          state_on: 3
#          state_off: 4

#    sensors:
#      # Status bus VE
#      # 0=Off;1=Low Power;2=Fault;3=Bulk;4=Absorption;5=Float;6=Storage;
#      # 7=Equalize;8=Passthru;9=Inverting;10=Power assist;11=Power supply;252=External control
#      - name: "MP2 Status bus VE"
#        unique_id: "mp2_status_bus_ve"
#        slave: 227
#        address: 31
#        data_type: uint16
#        scale: 1
